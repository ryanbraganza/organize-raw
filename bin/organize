#!/usr/bin/env node
'use strict';
const fs = require('fs');
const mv = require('mv');
const raw = './raw';
const video = './video';

// a function to move a file to a new directory
function moveFile (filePassed, dest) {
  // move the file to the destination directory
  mv(filePassed, `${dest}/${filePassed}`, function(err) {
    if(err) {
      console.log(err);
    }
  });
}

// a function to check to see if a directory exists. If it doesn't create one.
function dirCheck (dir) {
  if (!fs.existsSync(dir)){
    fs.mkdirSync(dir);
  }
}

fs.readdir('./', (err, files) => {

  // find each file in the directory
  files.forEach(file => {
    //console.log(file);
    const fileType = file.split('.')[1];
    
    // if CR2 file type move to raw directory
    if (fileType === 'json') {

      // if raw directory doesn't exist create one
      dirCheck ('raw');

      // move any CR2 file to raw directory
      moveFile (file, 'raw');
    }else if (fileType === 'MP4') {
      // if video directory doesn't exist create one
      dirCheck ('video');

      // move any MP4 file to video directory
      moveFile (file, 'video');
    }
  });

  // success message
  console.log('Files have been organized');
})